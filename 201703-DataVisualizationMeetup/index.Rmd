---
title: '<br><br>¡Un worflow para un Aficionado!<br><small>Y el cuento de como
R|Estadística nos ayuda a explorar contado a través de un ejemplo conocido
por todos nosotros</small>
<link href="https://fonts.googleapis.com/css?family=Bangers|Roboto+Condensed|Acme" rel="stylesheet">'
author: Joshua Kunst, Marzo 17
output:
  revealjs::revealjs_presentation:
    self_contained: false
    mathjax: null
    transition: fade
    css: styles.css
    incremental: true
    center: false
    theme: simple
    fig_width: 5
    fig_height: 4
    reveal_options:
      slideNumber: true
      controls: false
      mouseWheel: false
---

# Holas {.section-title-white .center data-background="http://i.giphy.com/oJiCqvIqPZE3u.gif"}

```{r, include = FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE, echo = FALSE)
library(tidyverse)
library(igraph)
library(highcharter)
library(viridis)
library(hrbrthemes)
library(jbkmisc)
theme_set(theme_jbk())
options(highcharter.theme = hc_theme_elementary())
```

## Me presento

- Soy Estadístico
- De día trabajo Riesgo (70%) y Proyectos personales (30%)
- Escribo código para compartir
- A veces aparezco en [highcharts.js](http://www.highcharts.com/blog/)
- Evangelizado[R](https://cran.r-project.org/)

## Que haremos?

Vengo a vende[R](https://cran.r-project.org/) y a [R](https://cran.r-project.org/)egalar.

- Motivar a quienes no han escrito código hace un tiempo a 
desempolvar esas manos
- Motivar a quien no ha escrito codigo para automatizar su workflow


## Como lo haremos?

- Revisar un worflow de trabajo
- Mostrar uno de mis _one-hit wonder_
- Presentar highcharter (PP)
- Jugar con un ejemplo guíado


# Workflow de <strike>trabajo</strike> vida del día a día

![DSflow](http://r4ds.had.co.nz/diagrams/data-science.png)

# Proyecto Personal

## 

![DSflow](https://raw.githubusercontent.com/jbkunst/highcharter/master/highcharter-logo.png)

- Que es? Wrapper de R para highcharts
- Que intenta ser? Más que un wrapper para highcharts.
- Como? Una ayuda a quienes no _js/html_ hablantes para hacer visualizaciones atractivas 
ofreciendo (EMHO) 

# Demo I: Metro {.section-title-white .center data-background="http://pre01.deviantart.net/b377/th/pre/f/2016/136/4/9/subway_wallpaper_by_nightbronies-da2pjzk.png" }

## Idea

Se tienen el ingreso promedio de personas cada media hora. Exploremos que
estaciones se _comportan_ de forma similar.

## Data
```{r}
data <- readRDS("data/data_subidas_metro.rds")
data
```

## Explorar
```{r}
d1 <- filter(data, paraderosubida %in% c("Plaza Maipu", "Laguna Sur")) 
hw_grid(
  d1 %>% 
    hchart("line", hcaes(mediahora, subidas_laboral_promedio, group = paraderosubida)) %>% 
    hc_xAxis(type = "datetime") %>% 
    hc_tooltip(sort = TRUE, table = TRUE, xDateFormat = "%H:%S"),
  d1 %>% 
    spread(paraderosubida, subidas_laboral_promedio) %>% 
    hchart("point", hcaes(`Laguna Sur`, `Plaza Maipu`, size = mediahora), maxSize = "5%") %>% 
    hc_xAxis(min = 0) %>% 
    hc_yAxis(min = 0)
) %>% htmltools::browsable()

```

## Explorar
```{r}
d2 <- filter(data, paraderosubida %in% c("Universidad De Chile", "Plaza De Puente Alto"))
hw_grid(
  d2 %>% 
    hchart("line", hcaes(mediahora, subidas_laboral_promedio, group = paraderosubida)) %>% 
    hc_xAxis(type = "datetime") %>% 
    hc_tooltip(sort = TRUE, table = TRUE, xDateFormat = "%H:%S"),
  d2 %>% 
    spread(paraderosubida, subidas_laboral_promedio) %>% 
    hchart("point", hcaes(`Plaza De Puente Alto`, `Universidad De Chile`, size = mediahora), maxSize = "5%") %>% 
    hc_xAxis(min = 0) %>% 
    hc_yAxis(min = 0)
) %>% htmltools::browsable()
```

## Correlaciones
```
dcor <- pairwise_cor(data, paraderosubida, mediahora, subidas_laboral_promedio,
                     upper = FALSE) 
```
```{r}
dcor <- readRDS("data/data_subidas_metro_cor.rds")
dcor
```

```
dcorf <- seleccionamos_las_mas_grandes(dcor)
```

## Network

``` 
g <- graph_from_data_frame(dcorf, directed = FALSE)
g <- maquillamos_red(g)
hchart(g)
```

```{r}
set.seed(1)
hchart(readRDS("data/data_g.rds"))
```

## Podemos hacerlo mejor?

## Autoencoder

![autoencoder](http://nghiaho.com/wp-content/uploads/2012/12/autoencoder_network1.png)

## Preparando Datos

```
data2 <- spread(data, mediahora, subidas_laboral_promedio)
data2
```
```{r}
data2 <- readRDS("data/data_subidas_metro_autoencoder.rds")
data2
```

## Resumir información
```{r}
dautoenc <- readRDS("data/data_subidas_metro_autoencoder_output.rds")
dautoenc
```


## Resumir información
```{r}
dautoenc <- readRDS("data/data_subidas_metro_autoencoder_output_km.rds")
```
```{r, echo=TRUE}
hchart(dautoenc, "point", hcaes(x = x, y = y), name = "Estaciones")
```

## Creamos grupos
```{r}
hchart(dautoenc, "point", hcaes(x, y, group = group, name = paraderosubida),
       dataLabels = list(enabled = TRUE, format =  "{point.name}")) %>% 
  hc_chart(zoomType = "xy") %>% 
  hc_colors(hex_to_rgba(viridis(4)))
```

## Qué nos dicen estos grupos?
```{r}
chartlst <- readRDS("data/data_subidas_metro_polysmooths.rds")

hw_grid(chartlst, ncol = 4) %>% htmltools::browsable()
```

## Y si agregamos GTFS {data-background-iframe="hcsw.html"}

## 
```{r}
readRDS("data/data_subidas_metro_hcsw.rds")
```


# En definitiva

- Utilice tanto h2o para el autoencoder (JAVA)
- Como highcharts (javascript)
- Por lo que R es buen lenguaje

# Gracias. Conversemos! { .center }

## Créditos

> - Eat eggs
> - Drink coffee



